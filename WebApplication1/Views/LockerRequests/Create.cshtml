@model WebApplication1.Models.LockerRequest

@{
    ViewData["Title"] = "Locker Request Form";
}

<div class="reservation-form-wrapper">
    <div class="form-header mb-4">
        <h2 style="color: white">Locker Request Form</h2>
        <p style="color: white">Please fill in the locker request details below</p>
    </div>

    <form asp-controller="LockerRequests" asp-action="Create" method="post" enctype="multipart/form-data" id="lockerRequestForm" class="needs-validation" novalidate>
        <div class="card shadow-sm">
            <div class="card-body bg-white">
                <div class="row g-4">
                    <div class="col-md-6">
                        <div class="form-floating mb-3">
                            <input asp-for="Name" class="form-control dark-text" placeholder="Full Name" 
                                   pattern="[a-zA-Z\s]+" title="Full Name must contain only letters and spaces" required />
                            <label asp-for="Name" class="dark-label">Full Name</label>
                            <span asp-validation-for="Name" class="text-danger"></span>
                        </div>
                    </div>

                    <div class="col-md-6">
                        <div class="form-floating mb-3">
                            <input asp-for="IdNumber" class="form-control dark-text" placeholder="Student ID" 
                                   pattern="\d{8}" maxlength="8" title="Student ID must be exactly 8 digits" required />
                            <label asp-for="IdNumber" class="dark-label">Student ID Number</label>
                            <span asp-validation-for="IdNumber" class="text-danger"></span>
                        </div>
                    </div>

                    <div class="col-md-6">
                        <div class="form-floating mb-3">
                            <input asp-for="LockerNumber" class="form-control dark-text" placeholder="Locker Number" 
                                   pattern="[A-Z0-9-]+" maxlength="20" title="Locker Number must contain only uppercase letters, numbers, and hyphens" 
                                   style="text-transform: uppercase;" />
                            <label asp-for="LockerNumber" class="dark-label">Locker Number</label>
                            <span asp-validation-for="LockerNumber" class="text-danger"></span>
                        </div>
                    </div>

                    <div class="col-md-6">
                        <div class="form-floating mb-3">
                            <select asp-for="Semester" class="form-select dark-text" required>
                                <option value="">Select Semester</option>
                                <option value="1st Semester">1st Semester</option>
                                <option value="2nd Semester">2nd Semester</option>
                            </select>
                            <label asp-for="Semester" class="dark-label">Semester</label>
                            <span asp-validation-for="Semester" class="text-danger"></span>
                        </div>
                    </div>

                    <div class="col-md-6">
                        <div class="form-floating mb-3">
                            <input asp-for="ContactNumber" class="form-control dark-text" placeholder="Contact Number" 
                                   pattern="(09|\+639)\d{9}" title="Enter a valid Philippine mobile number (e.g., 09171234567 or +639171234567)" required />
                            <label asp-for="ContactNumber" class="dark-label">Contact Number</label>
                            <span asp-validation-for="ContactNumber" class="text-danger"></span>
                        </div>
                    </div>

                    <div class="col-12">
                        <div class="mb-3">
                            <label class="form-label dark-label">Registration File (Upload)</label>
                            <input type="file" name="registrationFile" class="form-control" accept=".pdf,.jpg,.jpeg,.png" required data-val="true" data-val-required="Please upload your registration file" />
                            <div class="form-text text-dark">Accepted file types: PDF, JPG, JPEG, PNG</div>
                            @Html.ValidationMessage("registrationFile", new { @class = "text-danger" })
                        </div>
                    </div>

                    <div class="col-12">
                        <div class="form-check">
                            <input asp-for="TermsAccepted" class="form-check-input" required />
                            <label asp-for="TermsAccepted" class="form-check-label dark-label">
                                I accept the <a href="#" class="text-primary">Terms of Service</a> and <a href="#" class="text-primary">Locker Usage Policy</a>
                            </label>
                            <span asp-validation-for="TermsAccepted" class="text-danger d-block"></span>
                        </div>
                    </div>

                </div>
            </div>

            <div class="card-footer bg-white">
                <div class="d-flex justify-content-end gap-2">
                    <a asp-controller="Home" asp-action="Index" class="btn btn-outline-secondary text-dark">
                        <i class="fas fa-arrow-left me-2"></i>Back
                    </a>
                    <button type="submit" class="btn btn-primary">
                        <i class="fas fa-save me-2"></i>Submit Request
                    </button>
                    <a asp-controller="LockerRequests" asp-action="List" class="btn btn-primary">
                            View Request Lists
                    </a>
                </div>
            </div>
        </div>
    </form>
</div>

<style>
    .reservation-form-wrapper { max-width: 1000px; margin: 2rem auto; padding: 0 1rem; }
    .form-header h2 { color: #000; font-weight: 600; }
    .card { border: 1px solid #dee2e6; border-radius: 10px; }
    .form-floating > .form-control, .form-floating > .form-select { height: calc(3.5rem + 2px); line-height: 1.25; color: #000 !important; background-color: #fff !important; }
    .dark-text { color: #000 !important; }
    .dark-label { color: #495057 !important; }
    .btn-primary { background-color: #1a237e; border-color: #1a237e; color: #fff !important; }
</style>

@section Scripts {
    <script>
        (function () {
            'use strict'
            var forms = document.querySelectorAll('.needs-validation')
            Array.prototype.slice.call(forms).forEach(function (form) {
                form.addEventListener('submit', function (event) {
                    if (!form.checkValidity()) { event.preventDefault(); event.stopPropagation(); }
                    form.classList.add('was-validated')
                }, false)
            })
        })()

        // keep text black when typing
        document.querySelectorAll('.form-control, .form-select').forEach(function(element) {
            element.addEventListener('input', function() { this.style.color = '#000'; });
        });

        // file input visual feedback
        document.addEventListener('DOMContentLoaded', function(){
            var fileInput = document.querySelector('input[type="file"][name="registrationFile"]');
            if (fileInput) {
                fileInput.addEventListener('change', function(){
                    var fileName = this.files[0]?.name;
                    if (fileName) { this.classList.add('is-valid'); this.classList.remove('is-invalid'); }
                    else { this.classList.add('is-invalid'); this.classList.remove('is-valid'); }
                });
            }
        });
    </script>
    @{await Html.RenderPartialAsync("_ValidationScriptsPartial");}
}
